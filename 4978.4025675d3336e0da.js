"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4978],{4978:(k,Z,c)=>{c.r(Z),c.d(Z,{HomePageModule:()=>N});var d=c(6814),g=c(95),r=c(1929),E=c(5877),u=c(5861),m=c(9422),e=c(5678),T=c(2848),x=c(6402),M=c(9222);function y(o,l){if(1&o&&(e.TgZ(0,"ion-badge",4),e._uU(1),e.qZA()),2&o){const i=l.$implicit;e.xp6(1),e.Oqu(i)}}let H=(()=>{var o;class l{constructor(t,n,a){this.dataService=t,this.authService=n,this.nostrService=a}publishEvent(){var t=this;this.dataService.getContributors().subscribe(n=>{if(null!==n){for(var a of n){var s;null===(s=this.event.participants)||void 0===s||s.push(a.pubkey)}const _=this.authService.getPrivateKey(),h=new m.P0(_,this.event).createNostrCalendarEvent();console.log(h),this.dataService.getRelays().subscribe(function(){var v=(0,u.Z)(function*(f){if(null!==f){let C=[];for(var b of f)b.includes("purplepag")||C.push(b);console.log(C),yield t.nostrService.publishEventToPool(h,C)}});return function(f){return v.apply(this,arguments)}}())}})}}return(o=l).\u0275fac=function(t){return new(t||o)(e.Y36(T.D),e.Y36(x.$),e.Y36(M.B))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-event"]],inputs:{event:"event"},decls:17,vars:8,consts:[[1,"ion-text-wrap"],["color","primary",4,"ngFor","ngForOf"],["color","medium"],["fill","clear",3,"click"],["color","primary"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-card-subtitle"),e._uU(5),e.qZA()(),e.TgZ(6,"ion-card-content")(7,"ion-text",0),e._uU(8),e._UZ(9,"br"),e.YNc(10,y,2,1,"ion-badge",1),e.qZA(),e._UZ(11,"br"),e.TgZ(12,"ion-note",2),e._uU(13),e.ALo(14,"date"),e.qZA()(),e.TgZ(15,"ion-button",3),e.NdJ("click",function(){return n.publishEvent()}),e._uU(16,"Publish to Contributors"),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(n.event.name),e.xp6(2),e.Oqu(n.event.location),e.xp6(3),e.Oqu(n.event.content),e.xp6(2),e.Q6J("ngForOf",n.event.hashtags),e.xp6(3),e.Oqu(e.xi3(14,5,n.event.start,"shortDate")))},dependencies:[d.sg,r.yp,r.YG,r.PM,r.FN,r.Zi,r.tO,r.Dq,r.uN,r.yW,d.uU]}),l})();function w(o,l){1&o&&(e.TgZ(0,"ion-title"),e._uU(1,"Upcoming"),e.qZA())}function P(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"ion-searchbar",15),e.NdJ("ionInput",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.handleInput(n))})("ionClear",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.clearSearch())}),e.qZA()}2&o&&e.Q6J("debounce",500)}function J(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"ion-item-sliding"),e._UZ(1,"app-event",16),e.TgZ(2,"ion-item-options",17)(3,"ion-item-option",18)(4,"ion-icon",19),e.NdJ("click",function(){const a=e.CHM(i).index,s=e.oxw();return e.KtG(s.removeCalendarEvent(a))}),e.qZA()()()()}if(2&o){const i=l.$implicit;e.xp6(1),e.Q6J("event",i)}}function A(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"ion-datetime",34,35),e.NdJ("ngModelChange",function(n){e.CHM(i);const a=e.oxw(2);return e.KtG(a.startDate=n)}),e.qZA()}if(2&o){const i=e.oxw(2);e.Q6J("ngModel",i.startDate)}}function S(o,l){if(1&o){const i=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",4),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.cancel())}),e._uU(4,"Cancel"),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"New Event"),e.qZA(),e.TgZ(7,"ion-buttons",3)(8,"ion-button",20),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.confirm())}),e._uU(9,"Confirm"),e.qZA()()()(),e.TgZ(10,"ion-content",21)(11,"ion-list",22)(12,"ion-item")(13,"ion-input",23),e.NdJ("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.calendarEvent.name=n)}),e.qZA()(),e.TgZ(14,"ion-item")(15,"ion-input",24),e.NdJ("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.calendarEvent.location=n)}),e.qZA()()(),e.TgZ(16,"ion-list",22)(17,"ion-item"),e._UZ(18,"ion-datetime-button",25),e.TgZ(19,"ion-modal",26),e.YNc(20,A,2,1,"ng-template"),e.qZA()()(),e.TgZ(21,"ion-list",22)(22,"ion-item")(23,"ion-select",27)(24,"ion-select-option",28),e._uU(25,"Every Day"),e.qZA(),e.TgZ(26,"ion-select-option",29),e._uU(27,"Every Week"),e.qZA(),e.TgZ(28,"ion-select-option",30),e._uU(29,"Every 2 Weeks"),e.qZA(),e.TgZ(30,"ion-select-option",30),e._uU(31,"Every Month"),e.qZA(),e.TgZ(32,"ion-select-option",30),e._uU(33,"Every Year"),e.qZA()()()(),e.TgZ(34,"ion-list",22)(35,"ion-item")(36,"ion-input",31),e.NdJ("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.url=n)}),e.qZA()(),e.TgZ(37,"ion-item")(38,"ion-input",32),e.NdJ("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.hashtags=n)}),e.qZA()(),e.TgZ(39,"ion-item")(40,"ion-textarea",33),e.NdJ("ngModelChange",function(n){e.CHM(i);const a=e.oxw();return e.KtG(a.calendarEvent.content=n)}),e.qZA()()()()}if(2&o){const i=e.oxw();e.xp6(8),e.Q6J("strong",!0),e.xp6(3),e.Q6J("inset",!0),e.xp6(2),e.Q6J("ngModel",i.calendarEvent.name),e.xp6(2),e.Q6J("ngModel",i.calendarEvent.location),e.xp6(1),e.Q6J("inset",!0),e.xp6(3),e.Q6J("keepContentsMounted",!0),e.xp6(2),e.Q6J("inset",!0),e.xp6(13),e.Q6J("inset",!0),e.xp6(2),e.Q6J("ngModel",i.url),e.xp6(2),e.Q6J("ngModel",i.hashtags),e.xp6(2),e.Q6J("ngModel",i.calendarEvent.content)("autoGrow",!0)}}const q=[{path:"",component:(()=>{var o;class l{constructor(t,n,a){this.dataService=t,this.authService=n,this.nostrService=a,this.networkCalendarEvents=[],this.showingSearch=!1,this.calendarEvents=[],this.filteredCalendarEvents=[],this.home="Home",this.hashtags="",this.url="",this.startDate=(new Date).toISOString(),this.calendarEvent={name:"",content:"",start:new Date,hashtags:[],urls:[],participants:[]},this.loadCalendarEvents()}loadCalendarEvents(){var t=this;return(0,u.Z)(function*(){t.calendarEvents=[],t.dataService.GetCalendarEvents().subscribe(n=>{n.forEach(a=>{const s=new m.c4(a).convert();console.log(s),t.calendarEvents.push(s)}),t.calendarEvents.sort((a,s)=>a.start.getTime()-s.start.getTime()),t.filteredCalendarEvents=t.calendarEvents})})()}syncEventsFromNetwork(){var t=this;this.dataService.getRelays().subscribe(function(){var n=(0,u.Z)(function*(a){if(null!==a){let p=[];for(var s of a)p.push(s);for(var _ of(t.networkCalendarEvents=yield t.nostrService.getCalendarEvents(p),console.log(t.networkCalendarEvents),t.networkCalendarEvents)){const v=new m.c4(_).convert();t.calendarEvents.push(v)}}});return function(a){return n.apply(this,arguments)}}())}removeCalendarEvent(t){this.dataService.removeCalendarEvent(t),this.calendarEvents.splice(t,1)}addEventToCalendar(){var t=this;return(0,u.Z)(function*(){t.calendarEvent.start=new Date(t.startDate),t.calendarEvent.hashtags=t.getProcessedHashtags(),t.calendarEvent.urls=[t.url],t.calendarEvent.participants=[t.authService.getPublicKey()],console.log(t.calendarEvent);const n=t.authService.getPrivateKey();yield t.dataService.AddCalendarEvent(n,t.calendarEvent),t.resetCalendarEvent(),yield t.loadCalendarEvents()})()}getProcessedHashtags(){let t=this.hashtags.split(/[ ,]+/);return console.log(t),t}resetCalendarEvent(){this.calendarEvent={name:"",content:"",start:new Date}}cancel(){this.modal&&(this.resetCalendarEvent(),this.modal.dismiss(null,"cancel"))}confirm(){this.modal&&this.modal.dismiss(this.calendarEvent,"confirm")}onWillDismiss(t){"confirm"===t.detail.role&&this.addEventToCalendar()}showSearch(){console.log(this.showingSearch),this.showingSearch?(this.showingSearch=!1,this.filteredCalendarEvents=this.calendarEvents):this.showingSearch=!0}handleInput(t){if(t.target&&t.target.value){const n=t.target.value.toLowerCase();console.log(n),this.filteredCalendarEvents=""===n||null===n?this.calendarEvents:this.calendarEvents.filter(a=>a.name.toLowerCase().indexOf(n)>-1)}}clearSearch(){this.filteredCalendarEvents=this.calendarEvents}}return(o=l).\u0275fac=function(t){return new(t||o)(e.Y36(T.D),e.Y36(x.$),e.Y36(M.B))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-home"]],viewQuery:function(t,n){if(1&t&&e.Gf(r.ki,5),2&t){let a;e.iGM(a=e.CRH())&&(n.modal=a.first)}},decls:23,vars:6,consts:[[3,"translucent"],["slot","start"],[4,"ngIf"],["slot","end"],[3,"click"],["slot","icon-only","name","search"],["slot","icon-only","name","cloud-download-outline"],["show-clear-button","always",3,"debounce","ionInput","ionClear",4,"ngIf"],[3,"fullscreen"],["collapse","condense"],["size","large"],[4,"ngFor","ngForOf"],["slot","fixed","vertical","bottom","horizontal","end","id","open-modal"],["name","add"],["trigger","open-modal",3,"willDismiss"],["show-clear-button","always",3,"debounce","ionInput","ionClear"],[3,"event"],["side","end"],["color","danger"],["slot","icon-only","name","trash",3,"click"],[3,"strong","click"],[1,"ion-padding"],[3,"inset"],["type","text","placeholder","Title",3,"ngModel","ngModelChange"],["type","text","placeholder","Location or Video Call",3,"ngModel","ngModelChange"],["datetime","datetime"],[3,"keepContentsMounted"],["label","Repeat","placeholder","Never"],["value","apple"],["value","banana"],["value","orange"],["type","text","placeholder","URL",3,"ngModel","ngModelChange"],["type","text","placeholder","Categories",3,"ngModel","ngModelChange"],["type","text","placeholder","Description","cols","10",3,"ngModel","autoGrow","ngModelChange"],["label","Starts","id","datetime","locale","en-US",3,"ngModel","ngModelChange"],["datetime",""]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.YNc(4,w,2,0,"ion-title",2),e.TgZ(5,"ion-buttons",3)(6,"ion-button",4),e.NdJ("click",function(){return n.showSearch()}),e._UZ(7,"ion-icon",5),e.qZA(),e.TgZ(8,"ion-button",4),e.NdJ("click",function(){return n.syncEventsFromNetwork()}),e._UZ(9,"ion-icon",6),e.qZA()(),e.YNc(10,P,1,1,"ion-searchbar",7),e.qZA()(),e.TgZ(11,"ion-content",8)(12,"ion-header",9)(13,"ion-toolbar")(14,"ion-title",10),e._uU(15),e.qZA()()(),e.TgZ(16,"ion-list"),e.YNc(17,J,5,1,"ion-item-sliding",11),e.qZA(),e.TgZ(18,"ion-fab",12)(19,"ion-fab-button"),e._UZ(20,"ion-icon",13),e.qZA()(),e.TgZ(21,"ion-modal",14),e.NdJ("willDismiss",function(s){return n.onWillDismiss(s)}),e.YNc(22,S,41,12,"ng-template"),e.qZA()()),2&t&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("ngIf",!n.showingSearch),e.xp6(6),e.Q6J("ngIf",n.showingSearch),e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(4),e.Oqu(n.home),e.xp6(2),e.Q6J("ngForOf",n.filteredCalendarEvents))},dependencies:[d.sg,d.O5,g.JJ,g.On,r.YG,r.Sm,r.W2,r.x4,r.Mj,r.IJ,r.W4,r.Gu,r.gu,r.pK,r.Ie,r.u8,r.IK,r.td,r.q_,r.fG,r.VI,r.t9,r.n0,r.g2,r.wd,r.sr,r.ki,r.QI,r.j9,H]}),l})()}];let U=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[E.Bz.forChild(q),E.Bz]}),l})(),N=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.ez,g.u5,r.Pc,U]}),l})()}}]);