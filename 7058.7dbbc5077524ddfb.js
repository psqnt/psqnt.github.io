"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7058],{7058:(O,m,r)=>{r.r(m),r.d(m,{SettingsPageModule:()=>F});var g=r(6814),u=r(95),i=r(1929),h=r(5877),e=r(5678),d=r(6402);let v=(()=>{var n;class l{constructor(t){this.authService=t,this.npub="",this.nsec=""}ngOnInit(){this.npub=this.authService.npub(),this.nsec=this.authService.nsec()}}return(n=l).\u0275fac=function(t){return new(t||n)(e.Y36(d.$))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-keys"]],decls:22,vars:2,consts:[["fill","clear"]],template:function(t,o){1&t&&(e.TgZ(0,"h1"),e._uU(1,"Keys"),e.qZA(),e.TgZ(2,"ion-card")(3,"ion-card-header")(4,"ion-card-title"),e._uU(5,"npub"),e.qZA(),e.TgZ(6,"ion-card-subtitle"),e._uU(7,"nip-19 encoded public key"),e.qZA()(),e.TgZ(8,"ion-card-content"),e._uU(9),e.qZA(),e.TgZ(10,"ion-button",0),e._uU(11,"Copy"),e.qZA()(),e.TgZ(12,"ion-card")(13,"ion-card-header")(14,"ion-card-title"),e._uU(15,"nsec"),e.qZA(),e.TgZ(16,"ion-card-subtitle"),e._uU(17,"nip-19 encoded private key"),e.qZA()(),e.TgZ(18,"ion-card-content"),e._uU(19),e.qZA(),e.TgZ(20,"ion-button",0),e._uU(21,"Copy"),e.qZA()()),2&t&&(e.xp6(9),e.hij(" ",o.npub," "),e.xp6(10),e.hij(" ",o.nsec," "))},dependencies:[i.YG,i.PM,i.FN,i.Zi,i.tO,i.Dq]}),l})();var _=r(5861),y=r(2848);function T(n,l){if(1&n&&(e.TgZ(0,"ion-list")(1,"ion-item")(2,"ion-label"),e._uU(3),e.qZA()()()),2&n){const s=l.$implicit;e.xp6(3),e.Oqu(s)}}let C=(()=>{var n;class l{constructor(t){this.dataService=t,this.newRelay="",this.relays=[]}ngOnInit(){this.getRelays()}getRelays(){this.relays=[],this.dataService.getRelays().subscribe(t=>{t.forEach(o=>{this.relays.push(o)})})}saveRelay(){var t=this;return(0,_.Z)(function*(){console.log("saving"),console.log(t.newRelay),yield t.dataService.AddRelay(t.newRelay),t.newRelay="",t.getRelays()})()}}return(n=l).\u0275fac=function(t){return new(t||n)(e.Y36(y.D))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-relays"]],decls:9,vars:2,consts:[[1,"ion-padding"],["label","Add Relay","placeholder","wss://relay.damus.io/",3,"ngModel","ngModelChange"],[3,"click"],[4,"ngFor","ngForOf"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-content",0)(1,"h1"),e._uU(2,"Relays"),e.qZA(),e.TgZ(3,"ion-list")(4,"ion-item")(5,"ion-input",1),e.NdJ("ngModelChange",function(p){return o.newRelay=p}),e.qZA(),e.TgZ(6,"ion-button",2),e.NdJ("click",function(){return o.saveRelay()}),e._uU(7,"Save"),e.qZA()()(),e.YNc(8,T,4,1,"ion-list",3),e.qZA()),2&t&&(e.xp6(5),e.Q6J("ngModel",o.newRelay),e.xp6(3),e.Q6J("ngForOf",o.relays))},dependencies:[g.sg,u.JJ,u.On,i.YG,i.W2,i.pK,i.Ie,i.Q$,i.q_,i.j9]}),l})();var S=r(9422),w=r(9222);function b(n,l){if(1&n&&(e.TgZ(0,"div")(1,"h1"),e._uU(2,"Profile"),e.qZA(),e.TgZ(3,"ion-card")(4,"ion-card-content")(5,"ion-avatar"),e._UZ(6,"img",1),e.qZA()(),e.TgZ(7,"ion-card-header")(8,"ion-card-title"),e._uU(9),e.qZA()(),e.TgZ(10,"ion-card-content"),e._uU(11),e.qZA()()()),2&n){const s=e.oxw();e.xp6(6),e.s9C("src",s.picture,e.LSH),e.xp6(3),e.Oqu(s.userContent.name),e.xp6(2),e.hij(" ",s.userContent.about," ")}}function P(n,l){if(1&n){const s=e.EpF();e.TgZ(0,"div")(1,"h1"),e._uU(2,"Create Profile"),e.qZA(),e.TgZ(3,"ion-list")(4,"ion-item")(5,"ion-input",2),e.NdJ("ngModelChange",function(o){e.CHM(s);const a=e.oxw();return e.KtG(a.newName=o)}),e.qZA()(),e.TgZ(6,"ion-item")(7,"ion-input",3),e.NdJ("ngModelChange",function(o){e.CHM(s);const a=e.oxw();return e.KtG(a.newAbout=o)}),e.qZA()()(),e.TgZ(8,"ion-button",4),e.NdJ("click",function(){e.CHM(s);const o=e.oxw();return e.KtG(o.publishProfile())}),e._uU(9,"Publish Profile"),e.qZA()()}if(2&n){const s=e.oxw();e.xp6(5),e.Q6J("ngModel",s.newName),e.xp6(2),e.Q6J("ngModel",s.newAbout)}}function A(n,l){1&n&&e._UZ(0,"ion-spinner")}let U=(()=>{var n;class l{constructor(t,o,a){this.nostrService=t,this.dataService=o,this.authService=a,this.loading=!0,this.userEvent=null,this.newName="",this.newAbout="",this.userContent=null,this.picture="https://ionicframework.com/docs/img/demos/avatar.svg"}ngOnInit(){this.getUserFromRelayPool()}getUserFromRelayPool(){var t=this;return(0,_.Z)(function*(){t.dataService.getRelays().subscribe(function(){var o=(0,_.Z)(function*(a){if(null!==a){let f=[];for(var p of a)f.push(p);var c;t.userEvent=yield t.nostrService.getSelf(f),t.userEvent&&(t.userContent=JSON.parse(t.userEvent.content),null!==(c=t.userContent)&&void 0!==c&&c.picture&&(t.picture=t.userContent.picture)),t.loading=!1}});return function(a){return o.apply(this,arguments)}}())})()}publishProfile(){var t=this;const o=this.authService.getPrivateKey();let a=new S.cM(this.newName,this.newAbout,o);this.dataService.getRelays().subscribe(function(){var p=(0,_.Z)(function*(c){if(null!==c){let Z=[];for(var f of c)Z.push(f);t.nostrService.publishEventToPool(a.getSignedEvent(),Z)}});return function(c){return p.apply(this,arguments)}}())}}return(n=l).\u0275fac=function(t){return new(t||n)(e.Y36(w.B),e.Y36(y.D),e.Y36(d.$))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-profile"]],decls:3,vars:3,consts:[[4,"ngIf"],["alt","profile picture",3,"src"],["label","Name",3,"ngModel","ngModelChange"],["label","About",3,"ngModel","ngModelChange"],["expand","block",3,"click"]],template:function(t,o){1&t&&e.YNc(0,b,12,3,"div",0)(1,P,10,2,"div",0)(2,A,1,0,"ion-spinner",0),2&t&&(e.Q6J("ngIf",!o.loading&&o.userEvent&&o.userContent),e.xp6(1),e.Q6J("ngIf",!o.loading&&!o.userEvent),e.xp6(1),e.Q6J("ngIf",o.loading))},dependencies:[g.O5,u.JJ,u.On,i.BJ,i.YG,i.PM,i.FN,i.Zi,i.Dq,i.pK,i.Ie,i.q_,i.PQ,i.j9]}),l})(),x=(()=>{var n;class l{constructor(t,o){this.router=t,this.authService=o}signOut(){this.authService.clearKeys(),this.router.navigate(["/login"])}}return(n=l).\u0275fac=function(t){return new(t||n)(e.Y36(h.F0),e.Y36(d.$))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-signout"]],decls:8,vars:0,consts:[["color","danger"],["color","danger",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-content")(1,"h1"),e._uU(2,"Sign Out"),e.qZA(),e.TgZ(3,"ion-text",0)(4,"h3"),e._uU(5,"Signing out will wipe data from local database. Ensure anything you want saved is backed up or on Nostr"),e.qZA()(),e.TgZ(6,"ion-button",1),e.NdJ("click",function(){return o.signOut()}),e._uU(7,"Sign Out"),e.qZA()())},dependencies:[i.YG,i.W2,i.yW]}),l})();function J(n,l){if(1&n){const s=e.EpF();e.TgZ(0,"ion-list",11)(1,"ion-item",12),e.NdJ("click",function(){e.CHM(s);const o=e.oxw();return e.KtG(o.switchComponent("keys"))}),e._UZ(2,"ion-icon",13),e.TgZ(3,"ion-label")(4,"strong"),e._uU(5,"Keys"),e.qZA()()(),e.TgZ(6,"ion-item",12),e.NdJ("click",function(){e.CHM(s);const o=e.oxw();return e.KtG(o.switchComponent("relays"))}),e._UZ(7,"ion-icon",14),e.TgZ(8,"ion-label")(9,"strong"),e._uU(10,"Relays"),e.qZA()()(),e.TgZ(11,"ion-item",12),e.NdJ("click",function(){e.CHM(s);const o=e.oxw();return e.KtG(o.switchComponent("profile"))}),e._UZ(12,"ion-icon",15),e.TgZ(13,"ion-label")(14,"strong"),e._uU(15,"Profile"),e.qZA()()(),e.TgZ(16,"ion-item",12),e.NdJ("click",function(){e.CHM(s);const o=e.oxw();return e.KtG(o.switchComponent("signout"))}),e._UZ(17,"ion-icon",16),e.TgZ(18,"ion-label")(19,"strong"),e._uU(20,"Sign out"),e.qZA()()()()}2&n&&(e.Q6J("inset",!0),e.xp6(1),e.Q6J("button",!0),e.xp6(5),e.Q6J("button",!0),e.xp6(5),e.Q6J("button",!0),e.xp6(5),e.Q6J("button",!0))}function R(n,l){if(1&n){const s=e.EpF();e.TgZ(0,"ion-button",17),e.NdJ("click",function(){e.CHM(s);const o=e.oxw();return e.KtG(o.setAllComponentsFalse())}),e._UZ(1,"ion-icon",18),e._uU(2,"Back "),e.qZA()}}function q(n,l){1&n&&e._UZ(0,"app-keys")}function M(n,l){1&n&&e._UZ(0,"app-relays")}function k(n,l){1&n&&e._UZ(0,"app-profile")}function K(n,l){1&n&&e._UZ(0,"app-signout")}const N=[{path:"",component:(()=>{var n;class l{constructor(){this.showList=!0,this.showKeys=!1,this.showRelays=!1,this.showProfile=!1,this.showSignOut=!1}switchComponent(t){this.setAllComponentsFalse(),"keys"===t&&(this.showList=!1,this.showKeys=!0),"relays"===t&&(this.showList=!1,this.showRelays=!0),"profile"===t&&(this.showList=!1,this.showProfile=!0),"signout"===t&&(this.showList=!1,this.showSignOut=!0)}setAllComponentsFalse(){this.showList=!0,this.showKeys=!1,this.showRelays=!1,this.showProfile=!1,this.showSignOut=!1}}return(n=l).\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-settings"]],decls:24,vars:7,consts:[[3,"translucent"],["slot","start"],["slot","end"],["slot","icon-only","name","share-social-outline"],["slot","icon-only","name","add-outline"],["slot","icon-only","name","search"],["collapse","condense"],["size","large"],[3,"inset",4,"ngIf"],["fill","clear",3,"click",4,"ngIf"],[4,"ngIf"],[3,"inset"],[3,"button","click"],["color","primary","slot","start","name","key-outline","size","large"],["color","secondary","slot","start","name","server-outline","size","large"],["color","success","slot","start","name","person-circle-outline","size","large"],["color","danger","slot","start","name","power-sharp","size","large"],["fill","clear",3,"click"],["slot","start","name","chevron-back-outline"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Settings"),e.qZA(),e.TgZ(6,"ion-buttons",2)(7,"ion-button"),e._UZ(8,"ion-icon",3),e.qZA(),e.TgZ(9,"ion-button"),e._UZ(10,"ion-icon",4),e.qZA(),e.TgZ(11,"ion-button"),e._UZ(12,"ion-icon",5),e.qZA()()()(),e.TgZ(13,"ion-content")(14,"ion-header",6)(15,"ion-toolbar")(16,"ion-title",7),e._uU(17,"Settings"),e.qZA()()(),e.YNc(18,J,21,5,"ion-list",8)(19,R,3,0,"ion-button",9)(20,q,1,0,"app-keys",10)(21,M,1,0,"app-relays",10)(22,k,1,0,"app-profile",10)(23,K,1,0,"app-signout",10),e.qZA()),2&t&&(e.Q6J("translucent",!0),e.xp6(18),e.Q6J("ngIf",o.showList),e.xp6(1),e.Q6J("ngIf",!o.showList),e.xp6(1),e.Q6J("ngIf",o.showKeys),e.xp6(1),e.Q6J("ngIf",o.showRelays),e.xp6(1),e.Q6J("ngIf",o.showProfile),e.xp6(1),e.Q6J("ngIf",o.showSignOut))},dependencies:[g.O5,i.YG,i.Sm,i.W2,i.Gu,i.gu,i.Ie,i.Q$,i.q_,i.fG,i.wd,i.sr,v,C,U,x]}),l})()}];let Q=(()=>{var n;class l{}return(n=l).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.Bz.forChild(N),h.Bz]}),l})(),F=(()=>{var n;class l{}return(n=l).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.ez,u.u5,i.Pc,Q]}),l})()}}]);