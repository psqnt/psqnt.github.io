"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9854],{9854:(nt,G,m)=>{m.r(G),m.d(G,{SettingsPageModule:()=>Ge});var S=m(6814),Z=m(95),a=m(1929),M=m(5290),e=m(5678),u=m(5861),X=m(7911);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var J=function(n){return n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE",n}(J||{});class I extends Error{constructor(i,o,t){super(i),this.message=i,this.code=o,this.data=t}}const ne=n=>{var i,o,t,r,s;const c=n.CapacitorCustomPlatform||null,l=n.Capacitor||{},p=l.Plugins=l.Plugins||{},d=n.CapacitorPlatforms,v=(null===(i=null==d?void 0:d.currentPlatform)||void 0===i?void 0:i.getPlatform)||(()=>null!==c?c.name:(n=>{var i,o;return null!=n&&n.androidBridge?"android":null!==(o=null===(i=null==n?void 0:n.webkit)||void 0===i?void 0:i.messageHandlers)&&void 0!==o&&o.bridge?"ios":"web"})(n)),je=(null===(o=null==d?void 0:d.currentPlatform)||void 0===o?void 0:o.isNativePlatform)||(()=>"web"!==v()),He=(null===(t=null==d?void 0:d.currentPlatform)||void 0===t?void 0:t.isPluginAvailable)||(f=>{const g=Q.get(f);return!!(null!=g&&g.platforms.has(v())||Y(f))}),Y=(null===(r=null==d?void 0:d.currentPlatform)||void 0===r?void 0:r.getPluginHeader)||(f=>{var g;return null===(g=l.PluginHeaders)||void 0===g?void 0:g.find(A=>A.name===f)}),Q=new Map,Xe=(null===(s=null==d?void 0:d.currentPlatform)||void 0===s?void 0:s.registerPlugin)||((f,g={})=>{const A=Q.get(f);if(A)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),A.proxy;const T=v(),U=Y(f);let C;const Ve=function(){var _=(0,u.Z)(function*(){return!C&&T in g?C=C="function"==typeof g[T]?yield g[T]():g[T]:null!==c&&!C&&"web"in g&&(C=C="function"==typeof g.web?yield g.web():g.web),C});return function(){return _.apply(this,arguments)}}(),K=_=>{let h;const b=(...w)=>{const P=Ve().then(y=>{const x=((_,h)=>{var b,w;if(!U){if(_)return null===(w=_[h])||void 0===w?void 0:w.bind(_);throw new I(`"${f}" plugin is not implemented on ${T}`,J.Unimplemented)}{const P=null==U?void 0:U.methods.find(y=>h===y.name);if(P)return"promise"===P.rtype?y=>l.nativePromise(f,h.toString(),y):(y,x)=>l.nativeCallback(f,h.toString(),y,x);if(_)return null===(b=_[h])||void 0===b?void 0:b.bind(_)}})(y,_);if(x){const q=x(...w);return h=null==q?void 0:q.remove,q}throw new I(`"${f}.${_}()" is not implemented on ${T}`,J.Unimplemented)});return"addListener"===_&&(P.remove=(0,u.Z)(function*(){return h()})),P};return b.toString=()=>`${_.toString()}() { [capacitor code] }`,Object.defineProperty(b,"name",{value:_,writable:!1,configurable:!1}),b},W=K("addListener"),B=K("removeListener"),tt=(_,h)=>{const b=W({eventName:_},h),w=function(){var y=(0,u.Z)(function*(){const x=yield b;B({eventName:_,callbackId:x},h)});return function(){return y.apply(this,arguments)}}(),P=new Promise(y=>b.then(()=>y({remove:w})));return P.remove=(0,u.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield w()}),P},$=new Proxy({},{get(_,h){switch(h){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return U?tt:W;case"removeListener":return B;default:return K(h)}}});return p[f]=$,Q.set(f,{name:f,proxy:$,platforms:new Set([...Object.keys(g),...U?[T]:[]])}),$});return l.convertFileSrc||(l.convertFileSrc=f=>f),l.getPlatform=v,l.handleError=f=>n.console.error(f),l.isNativePlatform=je,l.isPluginAvailable=He,l.pluginMethodNoop=(f,g,A)=>Promise.reject(`${A} does not have an implementation of "${g}".`),l.registerPlugin=Xe,l.Exception=I,l.DEBUG=!!l.DEBUG,l.isLoggingEnabled=!!l.isLoggingEnabled,l.platform=l.getPlatform(),l.isNative=l.isNativePlatform(),l},L=(n=>n.Capacitor=ne(n))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),E=L.registerPlugin;class R{constructor(i){this.listeners={},this.windowListeners={},i&&(console.warn(`Capacitor WebPlugin "${i.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=i)}addListener(i,o){var t=this;this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(o);const s=this.windowListeners[i];s&&!s.registered&&this.addWindowListener(s);const c=function(){var p=(0,u.Z)(function*(){return t.removeListener(i,o)});return function(){return p.apply(this,arguments)}}(),l=Promise.resolve({remove:c});return Object.defineProperty(l,"remove",{value:(p=(0,u.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield c()}),function(){return p.apply(this,arguments)})}),l;var p}removeAllListeners(){var i=this;return(0,u.Z)(function*(){i.listeners={};for(const o in i.windowListeners)i.removeWindowListener(i.windowListeners[o]);i.windowListeners={}})()}notifyListeners(i,o){const t=this.listeners[i];t&&t.forEach(r=>r(o))}hasListeners(i){return!!this.listeners[i].length}registerWindowListener(i,o){this.windowListeners[o]={registered:!1,windowEventName:i,pluginEventName:o,handler:t=>{this.notifyListeners(o,t)}}}unimplemented(i="not implemented"){return new L.Exception(i,J.Unimplemented)}unavailable(i="not available"){return new L.Exception(i,J.Unavailable)}removeListener(i,o){var t=this;return(0,u.Z)(function*(){const r=t.listeners[i];if(!r)return;const s=r.indexOf(o);t.listeners[i].splice(s,1),t.listeners[i].length||t.removeWindowListener(t.windowListeners[i])})()}addWindowListener(i){window.addEventListener(i.windowEventName,i.handler),i.registered=!0}removeWindowListener(i){i&&(window.removeEventListener(i.windowEventName,i.handler),i.registered=!1)}}const z=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),H=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class ie extends R{getCookies(){return(0,u.Z)(function*(){const i=document.cookie,o={};return i.split(";").forEach(t=>{if(t.length<=0)return;let[r,s]=t.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=H(r).trim(),s=H(s).trim(),o[r]=s}),o})()}setCookie(i){return(0,u.Z)(function*(){try{const o=z(i.key),t=z(i.value),r=`; expires=${(i.expires||"").replace("expires=","")}`,s=(i.path||"/").replace("path=",""),c=null!=i.url&&i.url.length>0?`domain=${i.url}`:"";document.cookie=`${o}=${t||""}${r}; path=${s}; ${c};`}catch(o){return Promise.reject(o)}})()}deleteCookie(i){return(0,u.Z)(function*(){try{document.cookie=`${i.key}=; Max-Age=0`}catch(o){return Promise.reject(o)}})()}clearCookies(){return(0,u.Z)(function*(){try{const i=document.cookie.split(";")||[];for(const o of i)document.cookie=o.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(i){return Promise.reject(i)}})()}clearAllCookies(){var i=this;return(0,u.Z)(function*(){try{yield i.clearCookies()}catch(o){return Promise.reject(o)}})()}}E("CapacitorCookies",{web:()=>new ie});const oe=function(){var n=(0,u.Z)(function*(i){return new Promise((o,t)=>{const r=new FileReader;r.onload=()=>{const s=r.result;o(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>t(s),r.readAsDataURL(i)})});return function(o){return n.apply(this,arguments)}}();class le extends R{request(i){return(0,u.Z)(function*(){const o=((n,i={})=>{const o=Object.assign({method:n.method||"GET",headers:n.headers},i),r=((n={})=>{const i=Object.keys(n);return Object.keys(n).map(r=>r.toLocaleLowerCase()).reduce((r,s,c)=>(r[s]=n[i[c]],r),{})})(n.headers)["content-type"]||"";if("string"==typeof n.data)o.body=n.data;else if(r.includes("application/x-www-form-urlencoded")){const s=new URLSearchParams;for(const[c,l]of Object.entries(n.data||{}))s.set(c,l);o.body=s.toString()}else if(r.includes("multipart/form-data")||n.data instanceof FormData){const s=new FormData;if(n.data instanceof FormData)n.data.forEach((l,p)=>{s.append(p,l)});else for(const l of Object.keys(n.data))s.append(l,n.data[l]);o.body=s;const c=new Headers(o.headers);c.delete("content-type"),o.headers=c}else(r.includes("application/json")||"object"==typeof n.data)&&(o.body=JSON.stringify(n.data));return o})(i,i.webFetchExtra),t=((n,i=!0)=>n?Object.entries(n).reduce((t,r)=>{const[s,c]=r;let l,p;return Array.isArray(c)?(p="",c.forEach(d=>{l=i?encodeURIComponent(d):d,p+=`${s}=${l}&`}),p.slice(0,-1)):(l=i?encodeURIComponent(c):c,p=`${s}=${l}`),`${t}&${p}`},"").substr(1):null)(i.params,i.shouldEncodeUrlParams),r=t?`${i.url}?${t}`:i.url,s=yield fetch(r,o),c=s.headers.get("content-type")||"";let p,d,{responseType:l="text"}=s.ok?i:{};switch(c.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":d=yield s.blob(),p=yield oe(d);break;case"json":p=yield s.json();break;default:p=yield s.text()}const k={};return s.headers.forEach((v,N)=>{k[N]=v}),{data:p,headers:k,status:s.status,url:s.url}})()}get(i){var o=this;return(0,u.Z)(function*(){return o.request(Object.assign(Object.assign({},i),{method:"GET"}))})()}post(i){var o=this;return(0,u.Z)(function*(){return o.request(Object.assign(Object.assign({},i),{method:"POST"}))})()}put(i){var o=this;return(0,u.Z)(function*(){return o.request(Object.assign(Object.assign({},i),{method:"PUT"}))})()}patch(i){var o=this;return(0,u.Z)(function*(){return o.request(Object.assign(Object.assign({},i),{method:"PATCH"}))})()}delete(i){var o=this;return(0,u.Z)(function*(){return o.request(Object.assign(Object.assign({},i),{method:"DELETE"}))})()}}E("CapacitorHttp",{web:()=>new le});class ce extends R{write(i){var o=this;return(0,u.Z)(function*(){if(typeof navigator>"u"||!navigator.clipboard)throw o.unavailable("Clipboard API not available in this browser");if(void 0!==i.string)yield o.writeText(i.string);else if(i.url)yield o.writeText(i.url);else{if(!i.image)throw new Error("Nothing to write");if(!(typeof ClipboardItem<"u"))throw o.unavailable("Writing images to the clipboard is not supported in this browser");try{const t=yield(yield fetch(i.image)).blob(),r=new ClipboardItem({[t.type]:t});yield navigator.clipboard.write([r])}catch{throw new Error("Failed to write image")}}})()}read(){var i=this;return(0,u.Z)(function*(){if(typeof navigator>"u"||!navigator.clipboard)throw i.unavailable("Clipboard API not available in this browser");if(!(typeof ClipboardItem<"u"))return i.readText();try{const o=yield navigator.clipboard.read(),t=o[0].types[0],r=yield o[0].getType(t);return{value:yield i._getBlobData(r,t),type:t}}catch{return i.readText()}})()}readText(){var i=this;return(0,u.Z)(function*(){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.readText)throw i.unavailable("Reading from clipboard not supported in this browser");return{value:yield navigator.clipboard.readText(),type:"text/plain"}})()}writeText(i){var o=this;return(0,u.Z)(function*(){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.writeText)throw o.unavailable("Writting to clipboard not supported in this browser");yield navigator.clipboard.writeText(i)})()}_getBlobData(i,o){return new Promise((t,r)=>{const s=new FileReader;o.includes("image")?s.readAsDataURL(i):s.readAsText(i),s.onloadend=()=>{t(s.result)},s.onerror=c=>{r(c)}})}}const ue=E("Clipboard",{web:()=>new ce});let de=(()=>{var n;class i{constructor(){}copy(t){return(0,u.Z)(function*(){yield ue.write({string:t})})()}}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),i})();var F=m(6402);let pe=(()=>{var n;class i{constructor(t,r,s){this.toastService=t,this.copyService=r,this.authService=s,this.npub="",this.nsec=""}ngOnInit(){this.npub=this.authService.npub(),this.nsec=this.authService.nsec()}copyNsec(){var t=this;return(0,u.Z)(function*(){yield t.copyService.copy(t.nsec),yield(yield t.toastService.createToast("nsec copied",2e3,"bottom","success")).present()})()}copyNpub(){var t=this;return(0,u.Z)(function*(){yield t.copyService.copy(t.npub),yield(yield t.toastService.createToast("npub copied",2e3,"bottom","success")).present()})()}}return(n=i).\u0275fac=function(t){return new(t||n)(e.Y36(X.k),e.Y36(de),e.Y36(F.$))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-keys"]],decls:20,vars:2,consts:[["fill","clear",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e._uU(3,"npub"),e.qZA(),e.TgZ(4,"ion-card-subtitle"),e._uU(5,"nip-19 encoded public key"),e.qZA()(),e.TgZ(6,"ion-card-content"),e._uU(7),e.qZA(),e.TgZ(8,"ion-button",0),e.NdJ("click",function(){return r.copyNpub()}),e._uU(9,"Copy"),e.qZA()(),e.TgZ(10,"ion-card")(11,"ion-card-header")(12,"ion-card-title"),e._uU(13,"nsec"),e.qZA(),e.TgZ(14,"ion-card-subtitle"),e._uU(15,"nip-19 encoded private key"),e.qZA()(),e.TgZ(16,"ion-card-content"),e._uU(17),e.qZA(),e.TgZ(18,"ion-button",0),e.NdJ("click",function(){return r.copyNsec()}),e._uU(19,"Copy"),e.qZA()()),2&t&&(e.xp6(7),e.hij(" ",r.npub," "),e.xp6(10),e.hij(" ",r.nsec," "))},dependencies:[a.YG,a.PM,a.FN,a.Zi,a.tO,a.Dq]}),i})();var O=m(2848);function fe(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"ion-item-sliding")(1,"ion-item")(2,"ion-label"),e._uU(3),e.qZA()(),e.TgZ(4,"ion-item-options",5)(5,"ion-item-option",6)(6,"ion-icon",7),e.NdJ("click",function(){const s=e.CHM(o).index,c=e.oxw();return e.KtG(c.removeRelay(s))}),e.qZA()()()()}if(2&n){const o=i.$implicit;e.xp6(3),e.Oqu(o)}}let ge=(()=>{var n;class i{constructor(t){this.dataService=t,this.newRelay="",this.relays=[]}ngOnInit(){this.getRelays()}getRelays(){this.relays=[],this.dataService.getRelays().subscribe(t=>{t.forEach(r=>{this.relays.push(r)})})}saveRelay(){var t=this;return(0,u.Z)(function*(){yield t.dataService.AddRelay(t.newRelay),t.newRelay="",t.getRelays()})()}removeRelay(t){var r=this;return(0,u.Z)(function*(){yield r.dataService.removeRelay(t),r.relays.splice(t,1)})()}}return(n=i).\u0275fac=function(t){return new(t||n)(e.Y36(O.D))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-relays"]],decls:8,vars:3,consts:[[1,"ion-padding"],["label","Add Relay","placeholder","wss://relay.damus.io/",3,"ngModel","ngModelChange"],["expand","block",3,"click"],[3,"inset"],[4,"ngFor","ngForOf"],["side","end"],["color","danger"],["slot","icon-only","name","trash",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-content",0)(1,"ion-list")(2,"ion-item")(3,"ion-input",1),e.NdJ("ngModelChange",function(c){return r.newRelay=c}),e.qZA()()(),e.TgZ(4,"ion-button",2),e.NdJ("click",function(){return r.saveRelay()}),e._uU(5,"Save Relay"),e.qZA(),e.TgZ(6,"ion-list",3),e.YNc(7,fe,7,1,"ion-item-sliding",4),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("ngModel",r.newRelay),e.xp6(3),e.Q6J("inset",!0),e.xp6(1),e.Q6J("ngForOf",r.relays))},dependencies:[S.sg,Z.JJ,Z.On,a.YG,a.W2,a.gu,a.pK,a.Ie,a.u8,a.IK,a.td,a.Q$,a.q_,a.j9]}),i})();var _e=m(9422),D=m(9222);function he(n,i){if(1&n&&(e.TgZ(0,"ion-chip"),e._UZ(1,"ion-icon",4),e.TgZ(2,"ion-label"),e._uU(3),e.qZA()()),2&n){const o=e.oxw(2);e.xp6(3),e.Oqu(o.userContent.lud16)}}function me(n,i){if(1&n&&(e.TgZ(0,"ion-note"),e._uU(1),e.qZA()),2&n){const o=e.oxw(2);e.xp6(1),e.Oqu(o.userContent.pubkey)}}function ve(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"div")(1,"ion-button",1),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.syncUser())}),e._uU(2,"Sync Profile"),e.qZA(),e.TgZ(3,"ion-button",2),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.showEditProfile())}),e._uU(4,"Edit Profile"),e.qZA(),e.TgZ(5,"ion-card")(6,"ion-card-content")(7,"ion-avatar"),e._UZ(8,"img",3),e.qZA()(),e.TgZ(9,"ion-card-header")(10,"ion-card-title"),e._uU(11),e.qZA()(),e.TgZ(12,"ion-card-content"),e._uU(13),e._UZ(14,"br"),e.YNc(15,he,4,1,"ion-chip",0),e._UZ(16,"br"),e.YNc(17,me,2,1,"ion-note",0),e.qZA()()()}if(2&n){const o=e.oxw();e.xp6(8),e.s9C("src",o.userContent.picture,e.LSH),e.xp6(3),e.Oqu(o.userContent.name),e.xp6(2),e.hij(" ",o.userContent.about," "),e.xp6(2),e.Q6J("ngIf",o.userContent.lud16),e.xp6(2),e.Q6J("ngIf",o.userContent.pubkey)}}function ye(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"div")(1,"ion-list")(2,"ion-item")(3,"ion-input",5),e.NdJ("ngModelChange",function(r){e.CHM(o);const s=e.oxw();return e.KtG(s.newName=r)}),e.qZA()(),e.TgZ(4,"ion-item")(5,"ion-input",6),e.NdJ("ngModelChange",function(r){e.CHM(o);const s=e.oxw();return e.KtG(s.newAbout=r)}),e.qZA()()(),e.TgZ(6,"ion-button",7),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.publishProfile())}),e._uU(7,"Publish Profile"),e.qZA()()}if(2&n){const o=e.oxw();e.xp6(3),e.Q6J("ngModel",o.newName),e.xp6(2),e.Q6J("ngModel",o.newAbout)}}function be(n,i){1&n&&e._UZ(0,"ion-spinner")}let Ce=(()=>{var n;class i{constructor(t,r,s){this.nostrService=t,this.dataService=r,this.authService=s,this.loading=!0,this.editProfile=!1,this.userEvent=null,this.newName="",this.newAbout="",this.userContent=null,this.picture="https://ionicframework.com/docs/img/demos/avatar.svg"}ngOnInit(){this.getProfile()}getProfile(){var t=this;this.dataService.getProfiles().subscribe(function(){var r=(0,u.Z)(function*(s){null===s||s.length<1?yield t.syncUser():(t.userContent=s[0],t.loading=!1)});return function(s){return r.apply(this,arguments)}}())}syncUser(){var t=this;return(0,u.Z)(function*(){t.loading=!0,yield t.deleteProfiles(),t.dataService.getRelays().subscribe(function(){var r=(0,u.Z)(function*(s){if(null!==s){let l=[];for(var c of s)l.push(c);t.userEvent=yield t.nostrService.getSelf(l),console.log(t.userEvent),t.userEvent&&(t.userContent=JSON.parse(t.userEvent.content),t.userContent&&!t.userContent.hasOwnProperty("picture")&&(t.userContent.picture=t.picture),t.userContent&&(t.userContent.pubkey=t.userEvent.pubkey,yield t.dataService.addProfile(t.userContent))),t.loading=!1}});return function(s){return r.apply(this,arguments)}}())})()}deleteProfiles(){var t=this;return(0,u.Z)(function*(){yield t.dataService.removeAllProfiles()})()}publishProfile(){var t=this;return(0,u.Z)(function*(){yield t.deleteProfiles(),t.loading=!0,t.editProfile=!1;const r=t.authService.getPrivateKey();let s=new _e.cM(t.newName,t.newAbout,r);t.dataService.getRelays().subscribe(function(){var c=(0,u.Z)(function*(l){if(null!==l){let d=[];for(var p of l)d.push(p);console.log(d),yield t.nostrService.publishEventToPool(s.getSignedEvent(),d),t.getProfile()}});return function(l){return c.apply(this,arguments)}}())})()}showEditProfile(){this.editProfile=!this.editProfile}}return(n=i).\u0275fac=function(t){return new(t||n)(e.Y36(D.B),e.Y36(O.D),e.Y36(F.$))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-profile"]],decls:3,vars:3,consts:[[4,"ngIf"],["color","primary",3,"click"],["color","tertiary",3,"click"],["alt","profile picture",3,"src"],["name","flash","color","orange"],["label","Name",3,"ngModel","ngModelChange"],["label","About",3,"ngModel","ngModelChange"],["expand","block",3,"click"]],template:function(t,r){1&t&&e.YNc(0,ve,18,5,"div",0)(1,ye,8,2,"div",0)(2,be,1,0,"ion-spinner",0),2&t&&(e.Q6J("ngIf",!r.loading&&r.userContent&&!r.editProfile),e.xp6(1),e.Q6J("ngIf",!r.loading&&!r.userContent||r.editProfile),e.xp6(1),e.Q6J("ngIf",r.loading))},dependencies:[S.O5,Z.JJ,Z.On,a.BJ,a.YG,a.PM,a.FN,a.Zi,a.Dq,a.hM,a.gu,a.pK,a.Ie,a.Q$,a.q_,a.uN,a.PQ,a.j9]}),i})(),we=(()=>{var n;class i{constructor(t,r,s){this.router=t,this.authService=r,this.dataService=s}signOut(){this.authService.clearKeys(),this.dataService.clearAllData(),this.router.navigate(["/login"])}}return(n=i).\u0275fac=function(t){return new(t||n)(e.Y36(M.F0),e.Y36(F.$),e.Y36(O.D))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-signout"]],decls:6,vars:0,consts:[[1,"ion-padding"],["color","danger"],["color","danger",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-content",0)(1,"ion-text",1)(2,"h3"),e._uU(3,"Signing out will wipe data from local database. Ensure anything you want saved is backed up or on Nostr"),e.qZA()(),e.TgZ(4,"ion-button",2),e.NdJ("click",function(){return r.signOut()}),e._uU(5,"Sign Out"),e.qZA()())},dependencies:[a.YG,a.W2,a.yW]}),i})();function Pe(n,i){if(1&n&&(e.TgZ(0,"ion-chip"),e._UZ(1,"ion-icon",6),e.TgZ(2,"ion-label"),e._uU(3),e.qZA()()),2&n){const o=e.oxw().$implicit;e.xp6(3),e.Oqu(o.lud16)}}function Ze(n,i){if(1&n&&(e.TgZ(0,"ion-note"),e._uU(1),e.qZA()),2&n){const o=e.oxw().$implicit;e.xp6(1),e.Oqu(o.pubkey)}}function Te(n,i){if(1&n&&(e.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-avatar"),e._UZ(3,"img",5),e.qZA(),e.TgZ(4,"ion-card-title"),e._uU(5),e.qZA()(),e.TgZ(6,"ion-card-content"),e._uU(7),e._UZ(8,"br"),e.YNc(9,Pe,4,1,"ion-chip",0),e._UZ(10,"br"),e.YNc(11,Ze,2,1,"ion-note",0),e.qZA()()),2&n){const o=i.$implicit;e.xp6(3),e.s9C("src",o.picture,e.LSH),e.xp6(2),e.Oqu(o.name),e.xp6(2),e.hij(" ",o.about," "),e.xp6(2),e.Q6J("ngIf",o.lud16),e.xp6(2),e.Q6J("ngIf",o.pubkey)}}function xe(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"div")(1,"ion-searchbar",3),e.NdJ("ionInput",function(r){e.CHM(o);const s=e.oxw(2);return e.KtG(s.handleInput(r))})("ionClear",function(){e.CHM(o);const r=e.oxw(2);return e.KtG(r.clearSearch())}),e.qZA(),e.YNc(2,Te,12,5,"ion-card",4),e.qZA()}if(2&n){const o=e.oxw(2);e.xp6(1),e.Q6J("debounce",500),e.xp6(1),e.Q6J("ngForOf",o.filteredUserContents)}}function Se(n,i){1&n&&(e.TgZ(0,"div")(1,"ion-text"),e._uU(2,"No contacts found in database, click sync to pull from network"),e.qZA()())}function ke(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"div")(1,"ion-button",1),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.syncContacts())}),e._uU(2,"Sync Contacts"),e.qZA(),e.TgZ(3,"ion-button",2),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.deleteContactsFromDatabase())}),e._uU(4,"Delete Contacts"),e.qZA(),e.YNc(5,xe,3,2,"div",0)(6,Se,3,0,"div",0),e.qZA()}if(2&n){const o=e.oxw();e.xp6(5),e.Q6J("ngIf",o.userContents),e.xp6(1),e.Q6J("ngIf",!o.userContents)}}function Ae(n,i){1&n&&e._UZ(0,"ion-spinner")}let Ue=(()=>{var n;class i{constructor(t,r){this.nostrService=t,this.dataService=r,this.loading=!0,this.userEvents=[],this.userContents=[],this.filteredUserContents=[]}ngOnInit(){this.getContacts()}getContacts(){this.dataService.getContactList().subscribe(t=>{if(null===t)this.syncContacts();else for(var r of t)this.userContents.push(r);this.filteredUserContents=this.userContents,this.loading=!1})}syncContacts(){var t=this;return(0,u.Z)(function*(){t.loading=!0,yield t.deleteContactsFromDatabase(),t.dataService.getRelays().subscribe(function(){var r=(0,u.Z)(function*(s){if(null!==s){let p=[];for(var c of s)p.push(c);const d=yield t.nostrService.getContactList(p);if(d){const k=t.getPubkeysFromContactListEvent(d);for(var l of(t.userEvents=yield t.nostrService.getUsersFromContactList(p,k),t.userEvents)){let v=JSON.parse(l.content);v.pubkey=l.pubkey,v&&!v.hasOwnProperty("picture")&&(v.picture="https://axiumradonmitigations.com/wp-content/uploads/2015/01/icon-user-default.png"),t.userContents.push(v),yield t.dataService.addContact(v)}}}t.loading=!1});return function(s){return r.apply(this,arguments)}}())})()}deleteContacts(){var t=this;return(0,u.Z)(function*(){t.loading=!0,yield t.deleteContactsFromDatabase(),t.loading=!1})()}deleteContactsFromDatabase(){var t=this;return(0,u.Z)(function*(){yield t.dataService.removeAllContacts()})()}getPubkeysFromContactListEvent(t){let r=[];for(var s of t.tags)r.push(s[1]);return r}handleInput(t){if(t.target&&t.target.value){const r=t.target.value.toLowerCase();console.log(r),this.filteredUserContents=""===r||null===r?this.userContents:this.userContents.filter(s=>s.name.toLowerCase().indexOf(r)>-1)}}clearSearch(){this.filteredUserContents=this.userContents}}return(n=i).\u0275fac=function(t){return new(t||n)(e.Y36(D.B),e.Y36(O.D))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-contacts"]],decls:2,vars:2,consts:[[4,"ngIf"],["color","primary",3,"click"],["color","danger",3,"click"],["show-clear-button","always",3,"debounce","ionInput","ionClear"],[4,"ngFor","ngForOf"],["alt","profile picture",3,"src"],["name","flash","color","orange"]],template:function(t,r){1&t&&e.YNc(0,ke,7,2,"div",0)(1,Ae,1,0,"ion-spinner",0),2&t&&(e.Q6J("ngIf",!r.loading),e.xp6(1),e.Q6J("ngIf",r.loading))},dependencies:[S.sg,S.O5,a.BJ,a.YG,a.PM,a.FN,a.Zi,a.Dq,a.hM,a.gu,a.Q$,a.uN,a.VI,a.PQ,a.yW,a.j9]}),i})(),Je=(()=>{var n;class i{constructor(){this.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone}}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-timezone"]],decls:7,vars:2,consts:[[3,"inset"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-list",0)(1,"ion-item")(2,"ion-label")(3,"h1"),e._uU(4,"Timezone"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()()()()),2&t&&(e.Q6J("inset",!0),e.xp6(6),e.Oqu(r.timezone))},dependencies:[a.Ie,a.Q$,a.q_]}),i})(),Le=(()=>{var n;class i{constructor(t){this.dataService=t,this.theme="light",this.themeToggle=!1}ngOnInit(){this.getSavedTheme()}toggleChange(t){this.toggleDarkTheme(t.detail.checked)}toggleDarkTheme(t){this.saveTheme(t?"dark":"light"),document.body.classList.toggle("dark",t)}getSavedTheme(){this.dataService.getSavedTheme().subscribe(t=>{this.theme=null!==t?t[0]:"light","dark"===this.theme?(this.themeToggle=!0,document.body.classList.toggle("dark",!0)):(this.themeToggle=!1,document.body.classList.toggle("dark",!1))})}saveTheme(t){var r=this;return(0,u.Z)(function*(){yield r.dataService.setTheme(t)})()}}return(n=i).\u0275fac=function(t){return new(t||n)(e.Y36(O.D))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-appearance"]],decls:6,vars:2,consts:[[3,"inset"],["justify","space-between",3,"ngModel","ngModelChange","ionChange"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-list-header"),e._uU(1,"Appearance"),e.qZA(),e.TgZ(2,"ion-list",0)(3,"ion-item")(4,"ion-toggle",1),e.NdJ("ngModelChange",function(c){return r.themeToggle=c})("ionChange",function(c){return r.toggleChange(c)}),e._uU(5,"Dark Mode"),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("inset",!0),e.xp6(2),e.Q6J("ngModel",r.themeToggle))},dependencies:[Z.JJ,Z.On,a.Ie,a.q_,a.yh,a.ho,a.w]}),i})();function Oe(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"ion-list",7)(1,"ion-item",8),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.switchComponent("keys"))}),e._UZ(2,"ion-icon",9),e.TgZ(3,"ion-label")(4,"strong"),e._uU(5,"Keys"),e.qZA()()(),e.TgZ(6,"ion-item",8),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.switchComponent("relays"))}),e._UZ(7,"ion-icon",10),e.TgZ(8,"ion-label")(9,"strong"),e._uU(10,"Relays"),e.qZA()()(),e.TgZ(11,"ion-item",8),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.switchComponent("profile"))}),e._UZ(12,"ion-icon",11),e.TgZ(13,"ion-label")(14,"strong"),e._uU(15,"Profile"),e.qZA()()(),e.TgZ(16,"ion-item",8),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.switchComponent("contacts"))}),e._UZ(17,"ion-icon",12),e.TgZ(18,"ion-label")(19,"strong"),e._uU(20,"Contacts"),e.qZA()()(),e.TgZ(21,"ion-item",8),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.switchComponent("timezone"))}),e._UZ(22,"ion-icon",13),e.TgZ(23,"ion-label")(24,"strong"),e._uU(25,"Timezone"),e.qZA()()(),e.TgZ(26,"ion-item",8),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.switchComponent("appearance"))}),e._UZ(27,"ion-icon",14),e.TgZ(28,"ion-label")(29,"strong"),e._uU(30,"Appearance"),e.qZA()()(),e.TgZ(31,"ion-item",8),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.switchComponent("signout"))}),e._UZ(32,"ion-icon",15),e.TgZ(33,"ion-label")(34,"strong"),e._uU(35,"Sign out"),e.qZA()()()()}2&n&&(e.Q6J("inset",!0),e.xp6(1),e.Q6J("button",!0),e.xp6(5),e.Q6J("button",!0),e.xp6(5),e.Q6J("button",!0),e.xp6(5),e.Q6J("button",!0),e.xp6(5),e.Q6J("button",!0),e.xp6(5),e.Q6J("button",!0),e.xp6(5),e.Q6J("button",!0))}function qe(n,i){if(1&n){const o=e.EpF();e.TgZ(0,"ion-button",16),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.setAllComponentsFalse())}),e._UZ(1,"ion-icon",17),e._uU(2," Settings "),e.qZA()}}function Me(n,i){1&n&&e._UZ(0,"app-keys")}function Ie(n,i){1&n&&e._UZ(0,"app-relays")}function Ee(n,i){1&n&&e._UZ(0,"app-profile")}function Re(n,i){1&n&&e._UZ(0,"app-contacts")}function Fe(n,i){1&n&&e._UZ(0,"app-timezone")}function Ne(n,i){1&n&&e._UZ(0,"app-appearance")}function Qe(n,i){1&n&&e._UZ(0,"app-signout")}const Ke=[{path:"",component:(()=>{var n;class i{constructor(){this.title="Settings",this.showList=!0,this.showKeys=!1,this.showRelays=!1,this.showProfile=!1,this.showContacts=!1,this.showTimezone=!1,this.showAppearance=!1,this.showSignOut=!1}switchComponent(t){this.setAllComponentsFalse(),"keys"===t&&(this.title="Keys",this.showList=!1,this.showKeys=!0),"relays"===t&&(this.title="Relays",this.showList=!1,this.showRelays=!0),"profile"===t&&(this.title="Profile",this.showList=!1,this.showProfile=!0),"contacts"===t&&(this.title="Contacts",this.showList=!1,this.showContacts=!0),"timezone"===t&&(this.title="Timezone",this.showList=!1,this.showTimezone=!0),"appearance"===t&&(this.title="Appearance",this.showList=!1,this.showAppearance=!0),"signout"===t&&(this.title="Sign Out",this.showList=!1,this.showSignOut=!0)}setAllComponentsFalse(){this.title="Settings",this.showList=!0,this.showKeys=!1,this.showRelays=!1,this.showProfile=!1,this.showContacts=!1,this.showTimezone=!1,this.showAppearance=!1,this.showSignOut=!1}}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-settings"]],decls:20,vars:12,consts:[[3,"translucent"],["slot","start"],["collapse","condense"],["size","large"],[3,"inset",4,"ngIf"],["fill","clear",3,"click",4,"ngIf"],[4,"ngIf"],[3,"inset"],[3,"button","click"],["color","primary","slot","start","name","key-outline","size","large"],["color","secondary","slot","start","name","server-outline","size","large"],["color","success","slot","start","name","person-circle-outline","size","large"],["color","contacts","slot","start","name","people-outline","size","large"],["color","tertiary","slot","start","name","hourglass-outline","size","large"],["color","medium","slot","start","name","eye-outline","size","large"],["color","danger","slot","start","name","power-sharp","size","large"],["fill","clear",3,"click"],["slot","start","name","chevron-back-outline"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-header",2)(8,"ion-toolbar")(9,"ion-title",3),e._uU(10),e.qZA()()(),e.YNc(11,Oe,36,8,"ion-list",4)(12,qe,3,0,"ion-button",5)(13,Me,1,0,"app-keys",6)(14,Ie,1,0,"app-relays",6)(15,Ee,1,0,"app-profile",6)(16,Re,1,0,"app-contacts",6)(17,Fe,1,0,"app-timezone",6)(18,Ne,1,0,"app-appearance",6)(19,Qe,1,0,"app-signout",6),e.qZA()),2&t&&(e.Q6J("translucent",!0),e.xp6(5),e.Oqu(r.title),e.xp6(5),e.Oqu(r.title),e.xp6(1),e.Q6J("ngIf",r.showList),e.xp6(1),e.Q6J("ngIf",!r.showList),e.xp6(1),e.Q6J("ngIf",r.showKeys),e.xp6(1),e.Q6J("ngIf",r.showRelays),e.xp6(1),e.Q6J("ngIf",r.showProfile),e.xp6(1),e.Q6J("ngIf",r.showContacts),e.xp6(1),e.Q6J("ngIf",r.showTimezone),e.xp6(1),e.Q6J("ngIf",r.showAppearance),e.xp6(1),e.Q6J("ngIf",r.showSignOut))},dependencies:[S.O5,a.YG,a.Sm,a.W2,a.Gu,a.gu,a.Ie,a.Q$,a.q_,a.fG,a.wd,a.sr,pe,ge,Ce,we,Ue,Je,Le]}),i})()}];let $e=(()=>{var n;class i{}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[M.Bz.forChild(Ke),M.Bz]}),i})(),Ge=(()=>{var n;class i{}return(n=i).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[S.ez,Z.u5,a.Pc,$e]}),i})()}}]);